version: "2"

pipelines:
  default:
    - AnalyzeContent
    - ExtractSEOKeywords
    - GenerateMarketingBrief
    - GenerateArticle
    - OptimizeSEO
    - SuggestInternalDocs
    - FormatContent
    - ApplyDesignKit

# Context passing configuration for better data flow
context_passing:
  AnalyzeContent:
    output: "content_analysis_result"
    next_input: "content_analysis_result"
    data_structure: "Dict[str, Any]"
  ExtractSEOKeywords:
    input: "content_analysis_result"
    output: "seo_keywords_result"
    next_input: "seo_keywords_result"
    data_structure: "Dict[str, Any]"
  GenerateMarketingBrief:
    input: "seo_keywords_result"
    output: "marketing_brief_result"
    next_input: "marketing_brief_result"
    data_structure: "Dict[str, Any]"
  GenerateArticle:
    input: "marketing_brief_result"
    output: "article_result"
    next_input: "article_result"
    data_structure: "Dict[str, Any]"
  OptimizeSEO:
    input: "article_result"
    output: "seo_optimized_result"
    next_input: "seo_optimized_result"
    data_structure: "Dict[str, Any]"
  SuggestInternalDocs:
    input: "seo_optimized_result"
    output: "internal_docs_result"
    next_input: "internal_docs_result"
    data_structure: "Dict[str, Any]"
  FormatContent:
    input: "internal_docs_result"
    output: "formatted_content_result"
    next_input: "formatted_content_result"
    data_structure: "Dict[str, Any]"
  ApplyDesignKit:
    input: "formatted_content_result"
    output: "final_content_result"
    data_structure: "Dict[str, Any]"

sub_pipelines:
  content_analysis:
    - AnalyzeContentType
    - ExtractContentMetadata
    - ValidateContentStructure
  seo_keywords:
    - ExtractPrimaryKeywords
    - ExtractSecondaryKeywords
    - AnalyzeKeywordDensity
    - GenerateKeywordSuggestions
  marketing_brief:
    - GenerateBriefOutline
    - DefineTargetAudience
    - SetContentObjectives
    - CreateContentStrategy
  article_generation:
    - GenerateArticleStructure
    - WriteArticleContent
    - AddSupportingElements
    - ReviewArticleQuality
  seo_optimization:
    - OptimizeTitleTags
    - OptimizeMetaDescriptions
    - OptimizeHeadings
    - OptimizeContentStructure
    - AddInternalLinks
  internal_docs:
    - AnalyzeContentGaps
    - SuggestRelatedDocs
    - IdentifyCrossReferences
    - GenerateDocSuggestions
  content_formatting:
    - ApplyFormattingRules
    - OptimizeReadability
    - AddVisualElements
    - FinalizeContent
  design_kit:
    - SelectDesignTemplate
    - ApplyBrandGuidelines
    - GenerateVisualComponents
    - OptimizeResponsiveLayout
    - CreateVisualAssets
    - ValidateDesignCompliance

branching:
  AnalyzeContent:
    blog_post: content_analysis
    release_notes: content_analysis
    transcript: content_analysis
    email: content_analysis
    other: content_analysis

# Content source configuration
content_sources:
  enabled: true
  default_sources:
    - name: "local_content"
      type: "file"
      enabled: true
      config:
        file_paths: ["content/", "data/"]
        file_patterns: ["content/**/*.md", "content/**/*.json", "data/**/*.txt"]
        watch_directory: true
        supported_formats: [".md", ".json", ".txt", ".yaml", ".yml"]
    
    - name: "content_api"
      type: "api"
      enabled: false
      config:
        base_url: "${CONTENT_API_URL}"
        endpoints: ["/content", "/posts", "/articles"]
        auth_type: "api_key"
        auth_config:
          key_name: "X-API-Key"
          key_value: "${CONTENT_API_KEY}"
    
    - name: "content_database"
      type: "database"
      enabled: false
      config:
        connection_string: "${CONTENT_DATABASE_URL}"
        query: "SELECT * FROM content"
        table_name: "content"
    
    - name: "web_content"
      type: "web_scraping"
      enabled: false
      config:
        urls: "${SCRAPE_URLS}"
        selectors:
          title: "h1, .title, .headline"
          content: "article, .content, .post-content"
          snippet: ".excerpt, .summary"
        max_pages: 10
        delay_between_requests: 1.0

  polling:
    enabled: true
    interval: 300  # seconds
    batch_size: 10
  
  caching:
    enabled: true
    ttl: 300  # seconds
    max_size: 1000  # items
